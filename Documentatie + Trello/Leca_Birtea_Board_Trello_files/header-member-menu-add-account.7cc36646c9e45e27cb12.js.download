(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{"./app/gamma/src/components/popovers/account-switcher/add-account.tsx":function(e,n,t){"use strict";t.r(n),t.d(n,"AddAccount",(function(){return _}));var a=t("./node_modules/react/index.js"),o=t.n(a),s=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),c=t.n(s),r=t("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/dist/cjs.js?!./node_modules/less-loader/dist/cjs.js?!./app/gamma/src/components/popovers/account-switcher/add-account.less"),i={insert:"head",singleton:!1},d=(c()(r.a,i),r.a.locals||{}),l=t("./packages/i18n/index.ts"),u=t("./packages/nachos/button.ts"),p=t("./packages/storage/index.ts"),m=t("./packages/atlassian-analytics/index.ts"),g=t("./packages/config/index.ts");const h=Object(l.forTemplate)("header_account_switcher"),j=e=>{m.Analytics.sendTrackEvent({action:"failed",actionSubject:"accountSwitcher",source:"accountSwitcherAddAccountInlineDialog",attributes:{reason:e||"Trello account not found"}})},_=({initialEmail:e,policy:n})=>{const[t,s]=Object(a.useState)(!1),[c,r]=Object(a.useState)(""),[i,l]=Object(a.useState)(n||{url:"",reason:""}),_=async()=>{l({url:"",reason:""}),s(!1);try{const{url:e,reason:n}=await(async e=>{const n=new URLSearchParams({email:e}).toString(),t=await fetch("/auth/accountSwitcher/policy?".concat(n),{method:"GET",headers:{"X-Trello-Client-Version":g.clientVersion,credentials:"include"}});if(!t.ok)throw new Error("error getting account switcher policy");return t.json()})(c);n&&0===e.indexOf(window.location.origin)?(j(n),l({url:e,reason:n})):e&&(m.Analytics.sendTrackEvent({action:"added",actionSubject:"accountSwitcher",source:"accountSwitcherAddAccountInlineDialog"}),p.TrelloStorage.set("accountSwitcherAccountAdded","true"),window.location.href=e)}catch(e){l({url:"",reason:"not found"}),j(null)}};Object(a.useEffect)((()=>{m.Analytics.sendScreenEvent({name:"accountSwitcherAddAccountInlineDialog"})}),[]);return o.a.createElement("div",{className:d.addAccount},o.a.createElement("p",{className:d.instructions},h("enter-the-email-for-the-account-youd-like-to-add")),o.a.createElement("form",{onSubmit:e=>{e.preventDefault(),t&&_()}},o.a.createElement("input",{className:d.email,placeholder:h("enter-email"),onChange:e=>{s(e.currentTarget.value.length>0),r(e.currentTarget.value),l({url:"",reason:""})},value:e}),"not found"===i.reason&&o.a.createElement("p",{className:d.notFoundError},h("there-isnt-an-account-for-this-email")),"migration ineligible"!==i.reason&&"migration required"!==i.reason&&o.a.createElement(u.Button,{isDisabled:!t,className:d.continueButton,onClick:_,appearance:"primary"},h("continue"))),("migration ineligible"===i.reason||"migration required"===i.reason)&&o.a.createElement(o.a.Fragment,null,o.a.createElement("p",{className:d.addAccountError},h("this-account-requires-a-few-updates-before-it-can-be-added")),o.a.createElement(u.Button,{className:d.upgradeButton,appearance:"primary",onClick:()=>{p.TrelloStorage.set("accountSwitcherAccountAdded","true"),m.Analytics.sendUIEvent({action:"clicked",actionSubject:"button",source:"accountSwitcherAddAccountInlineDialog",actionSubjectId:"accountSwitcherLoginAndUpdateButton"}),window.location.href=i.url}},h("log-in-and-update"))))};n.default=_},"./app/gamma/src/components/popovers/account-switcher/upgrade-account.tsx":function(e,n,t){"use strict";t.r(n);var a=t("./node_modules/react/index.js"),o=t.n(a),s=t("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),c=t.n(s),r=t("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/dist/cjs.js?!./node_modules/less-loader/dist/cjs.js?!./app/gamma/src/components/popovers/account-switcher/upgrade-account.less"),i={insert:"head",singleton:!1},d=(c()(r.a,i),r.a.locals||{}),l=t("./packages/i18n/index.ts"),u=t("./packages/nachos/button.ts");const p=Object(l.forTemplate)("header_account_switcher");n.default=({onClickUpdateAccount:e,isMigratable:n})=>o.a.createElement("div",{className:d.upgradeAccount},o.a.createElement("div",{className:d.blurb},p("your-account-requires-a-few-updates-before-it-can-be-added")),o.a.createElement("div",{className:d.cta},n&&o.a.createElement(u.Button,{onClick:e,appearance:"primary"},p("continue"))))},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/dist/cjs.js?!./node_modules/less-loader/dist/cjs.js?!./app/gamma/src/components/popovers/account-switcher/add-account.less":function(e,n,t){"use strict";var a=t("./node_modules/css-loader/dist/runtime/api.js"),o=t.n(a)()(!1);o.push([e.i,"._3e84l_ApFF8s_X {\n  padding: 12px 12px 0 12px;\n}\n._3qnF2aTX99VOat {\n  width: 100%;\n}\n._2fZSG5LwBo5y_o {\n  font-size: 12px;\n  color: #EB5A46;\n}\n._1JDnJuNB2esoi4 {\n  font-size: 12px;\n  color: #EB5A46;\n}\n._3px5MdjykOvXs- {\n  padding: 0 12px 12px 12px;\n  font-size: 12px;\n}\n",""]),o.locals={addAccount:"_3e84l_ApFF8s_X",email:"_3qnF2aTX99VOat",addAccountError:"_2fZSG5LwBo5y_o",notFoundError:"_1JDnJuNB2esoi4",tip:"_3px5MdjykOvXs-"},n.a=o},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/dist/cjs.js?!./node_modules/less-loader/dist/cjs.js?!./app/gamma/src/components/popovers/account-switcher/upgrade-account.less":function(e,n,t){"use strict";var a=t("./node_modules/css-loader/dist/runtime/api.js"),o=t.n(a)()(!1);o.push([e.i,"._3FyuZBmzrFiR8H {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n}\n._3oevnZdf5FYLlr {\n  margin: 4px;\n  padding: 4px;\n}\n._2UVGfusRBNVpsO {\n  margin: 8px;\n}\n",""]),o.locals={upgradeAccount:"_3FyuZBmzrFiR8H",blurb:"_3oevnZdf5FYLlr",cta:"_2UVGfusRBNVpsO"},n.a=o}}]);
//# sourceMappingURL=header-member-menu-add-account.7cc36646c9e45e27cb12.js.map